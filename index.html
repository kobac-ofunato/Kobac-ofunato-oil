from pathlib import Path
import re
from textwrap import dedent
from zipfile import ZipFile
from urllib.parse import quote

# Working folder
out_dir = Path("/mnt/data/kobac-oofunato-final")
out_dir.mkdir(parents=True, exist_ok=True)
index_path = out_dir / "index.html"

# Paste the user's current HTML
current_html = """<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ–°è¦é™å®šï¼ã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«äº¤æ›500å††ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é–‹å‚¬ä¸­ï¼ | è»Šæ¤œã®ã‚³ãƒãƒƒã‚¯å¤§èˆ¹æ¸¡åº—</title>

  <!-- OGP -->
  <meta property="og:title" content="æ–°è¦é™å®šï¼ã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«äº¤æ›500å††ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é–‹å‚¬ä¸­ï¼ | è»Šæ¤œã®ã‚³ãƒãƒƒã‚¯å¤§èˆ¹æ¸¡åº—" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="" />
  <meta property="og:image" content="" />
  <meta property="og:site_name" content="è»Šæ¤œã®ã‚³ãƒãƒƒã‚¯å¤§èˆ¹æ¸¡åº—" />
  <meta property="og:description" content="å¤§èˆ¹æ¸¡åº—é™å®šãƒ»æ–°è¦ã®ãŠå®¢æ§˜å‘ã‘ã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«äº¤æ›500å††ï¼ä½œæ¥­å—ä»˜æ™‚é–“ 9:00ã€œ17:00ã€‚ãŠé›»è©±ã§ãŠæ°—è»½ã«ã©ã†ãã€‚0120-589-196" />

  <!-- ãƒ•ã‚¡ãƒ“ã‚³ãƒ³ï¼ˆä»»æ„å·®ã—æ›¿ãˆå¯ï¼‰ -->
  <link rel="apple-touch-icon-precomposed" href="images/apple-touch-icon-precomposed.png" />
  <link type="image/png" rel="shortcut icon" href="images/favicon.png" />
  <link rel="icon" href="/img/logo_boy.png"/>

  <!-- å‚ç…§ã‚µã‚¤ãƒˆã®CSSã‚’æµç”¨ï¼ˆå¿…è¦ã«å¿œã˜ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã«å·®ã—æ›¿ãˆæ¨å¥¨ï¼‰ -->
  <link rel="stylesheet" href="https://sasebo.kobac-campaign-lp.com/oil/wp-content/themes/oishiimono/css/style.min.css">
  <link rel="stylesheet" href="https://sasebo.kobac-campaign-lp.com/oil/wp-content/themes/oishiimono/css/add.css">

  <!-- ãƒ•ã‚©ãƒ³ãƒˆ/JSï¼ˆå¿…è¦æœ€å°é™ã«çµã‚Šã€è¨ˆæ¸¬ã‚¿ã‚°ã¯å‰Šé™¤ï¼‰ -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

  <style>
    /* è¿½åŠ ã®ä¸Šæ›¸ãï¼ˆä½ä¸–ä¿â†’å¤§èˆ¹æ¸¡å‘ã‘ã®å¾®èª¿æ•´ï¼‰ */
    :root { --kobac-red:#E60012; }
    .tel-only { text-align:center; margin: 12px 0 0; }
    .tel-only .tel-cta { display:inline-block; background:var(--kobac-red); color:#fff; text-decoration:none;
                         padding:12px 22px; border-radius:10px; font-weight:800; }
    /* é›»è©±å›ºå®šãƒœã‚¿ãƒ³ï¼ˆSPï¼‰ */
    .sticky-tel { position: fixed; left:0; right:0; bottom:0; display:block; background:var(--kobac-red);
                  color:#fff; text-align:center; padding:14px 0; font-weight:800; text-decoration:none; z-index:200; }
    @media (min-width: 768px) { .sticky-tel { display:none; } }
    /* ãƒãƒƒãƒ—ã¯å¤–éƒ¨ãƒœã‚¿ãƒ³ã§é–‹ã */
    .map-btn { display:inline-block; background:var(--kobac-red); color:#fff; padding:10px 16px; border-radius:8px;
               text-decoration:none; font-weight:700; }
    /* å‚ç…§ãƒ†ãƒ¼ãƒä¾å­˜ã®ä½™ç™½ã‚’è‹¥å¹²è©°ã‚ã‚‹ */
    #campaign .campaign__time-number { font-weight: 800; }
  </style>
</head>

<body class="home blog">
  <header id="header" class="header">
    <div class="inner">
      <h1 class="logo"><a href="#">
        <picture class="mv-img">
          <source srcset="images/logo.svg" media="(min-width: 768px)"/>
          <img src="images/sp-logo.svg" alt="è»Šæ¤œã®ã‚³ãƒãƒƒã‚¯">
        </picture>
      </a></h1>
    </div>
  </header>

  <!-- ãƒ¡ã‚¤ãƒ³ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ« -->
  <section id="mv" class="mv">
    <div class="inner">
      <picture class="mv-img">
        <source srcset="images/pc-mv-img.png" media="(min-width: 768px)"/>
        <img src="images/sp-mv-img.jpg" alt="ã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«äº¤æ›ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³">
      </picture>

      <!-- é›»è©±ã®ã¿å°ç·šã«å¤‰æ›´ -->
      <div class="contact-nav">
        <div class="tel-only">
          <a class="tel-cta" href="tel:0120-589-196">ğŸ“ 0120-589-196 ã«é›»è©±ã™ã‚‹</a>
        </div>
      </div>
    </div>
  </section>

  <!-- ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æƒ…å ± -->
  <section id="campaign" class="campaign">
    <div class="inner">
      <div class="store02title"><span>è»Šæ¤œã®ã‚³ãƒãƒƒã‚¯ å¤§èˆ¹æ¸¡åº—</span></div>
      <div class="campaign__time">
        <span class="campaign__time-text">ä½œæ¥­å—ä»˜æ™‚é–“</span>
        <h3 class="campaign__time-number">9ï¼š00ã€œ17ï¼š00</h3>
      </div>
    </div>
    <img src="images/triangle.svg" alt="" class="traiangle is-sp">
  </section>

  <!-- ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨´æ±‚ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆç”»åƒé¡ã¯å¿…è¦ã«å¿œã˜ã¦å·®ã—æ›¿ãˆï¼‰ -->
  <section id="info" class="info">
    <div class="inner">
      <picture class="info-img">
        <source srcset="images/pc-web-point.svg" media="(min-width: 768px)"/>
        <img src="images/pc-web-point.svg" alt="WEBé™å®šãƒã‚¤ãƒ³ãƒˆ">
      </picture>
    </div>
  </section>

  <section id="cp" class="cp">
    <div class="inner">
      <picture class="present-img">
        <source srcset="images/cp.png" media="(min-width: 768px)"/>
        <img src="images/cp.png" alt="ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å†…å®¹">
      </picture>
    </div>
  </section>

  <section id="point03" class="point03">
    <div class="inner">
      <picture class="present-img">
        <source srcset="images/point03.png" media="(min-width: 768px)"/>
        <img src="images/point03_sp.png" alt="ãƒã‚¤ãƒ³ãƒˆ">
      </picture>
    </div>
  </section>

  <!-- é›»è©±ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆé›»è©±ã®ã¿ï¼‰ -->
  <section id="contact" class="contact">
    <div class="inner">
      <div class="contact-2store">
        <a href="tel:0120-589-196">
          <img src="images/conact01.svg" class="is-pc" alt="é›»è©±ã§å•ã„åˆã‚ã›">
          <img src="images/conact01_sp.svg" class="is-sp" alt="é›»è©±ã§å•ã„åˆã‚ã›">
        </a>
      </div>
    </div>
  </section>

  <section id="engine" class="engine">
    <div class="inner">
      <picture class="present-img">
        <source srcset="images/engine.png" media="(min-width: 768px)"/>
        <img src="images/engine.png" alt="ã‚¨ãƒ³ã‚¸ãƒ³è±†çŸ¥è­˜">
      </picture>
    </div>
  </section>

  <section id="plus_content" class="plus_content">
    <div class="inner">
      <picture class="present-img">
        <source srcset="images/plus_content.svg" media="(min-width: 768px)"/>
        <img src="images/plus_content.svg" alt="è¿½åŠ æƒ…å ±">
      </picture>
    </div>
  </section>

  <section id="step_content" class="step_content">
    <div class="inner">
      <picture class="present-img">
        <source srcset="images/step_content.svg" media="(min-width: 768px)"/>
        <img src="images/step_content.svg" alt="ã”åˆ©ç”¨ã®æµã‚Œ">
      </picture>
    </div>
  </section>

  <!-- å†åº¦ã®é›»è©±å°ç·š -->
  <section id="contact2" class="contact">
    <div class="inner">
      <div class="contact-2store">
        <a href="tel:0120-589-196">
          <img src="images/conact01.svg" class="is-pc" alt="é›»è©±ã§å•ã„åˆã‚ã›">
          <img src="images/conact01_sp.svg" class="is-sp" alt="é›»è©±ã§å•ã„åˆã‚ã›">
        </a>
      </div>
    </div>
  </section>

  <!-- å®Ÿæ–½åº—èˆ—è©³ç´°ï¼ˆå¤§èˆ¹æ¸¡åº—ã«å¤‰æ›´ï¼‰ -->
  <section id="shop" class="shop">
    <h2 class="shop-title">å®Ÿæ–½åº—èˆ—è©³ç´°</h2>
    <div class="inner">
      <div class="access-area">
        <h3 class="access-area__title">â–  è»Šæ¤œã®ã‚³ãƒãƒƒã‚¯ å¤§èˆ¹æ¸¡åº—</h3>
        <ul class="access-area__list">
          <li class="access-area__item">ä½æ‰€ / å²©æ‰‹çœŒå¤§èˆ¹æ¸¡å¸‚çŒªå·ç”ºä¹…åç•‘4-30</li>
          <li class="access-area__item">å–¶æ¥­æ™‚é–“ / 9:00ã€œ18:00</li>
          <li class="access-area__item">é›»è©±ç•ªå· / <a href="tel:0120-589-196">0120-589-196</a></li>
          <li class="access-area__item">å®šä¼‘æ—¥ / ç«æ›œã€æ°´æ›œã€GWã€å¤å­£ä¼‘æš‡ã€å¹´æœ«å¹´å§‹</li>
        </ul>
      </div>
      <div class="map" style="text-align:center;">
        <a class="map-btn" href="https://maps.app.goo.gl/uu4b8K8NXsCAYwnf8" target="_blank" rel="noopener">ğŸ—º Googleãƒãƒƒãƒ—ã‚’é–‹ã</a>
      </div>
    </div>
  </section>

  <footer id="footer" class="footer">
    <div class="logo"><img src="images/footer-logo.svg" alt="ãƒ•ãƒƒã‚¿ãƒ¼ãƒ­ã‚´"></div>
    <div class="copy">å½“ã‚µã‚¤ãƒˆå†…ã«æ²è¼‰ã•ã‚Œã¦ã„ã‚‹å…¨ã¦ã®ç”»åƒãƒ»æ–‡ç« ã®è»¢è¼‰ã€è»¢ç”¨ã‚’ç¦æ­¢ã—ã¾ã™ã€‚Â© KOBAC Co.,Ltd. All rights reserved.</div>
    <div class="pagetop"><a href="#mv"><img src="images/pagetop.svg" alt=""></a></div>
  </footer>

  <!-- ã‚¹ãƒãƒ›ä¸‹éƒ¨å›ºå®šTELãƒœã‚¿ãƒ³ -->
  <a href="tel:0120-589-196" class="sticky-tel">ğŸ“ ä»Šã™ãé›»è©±</a>
</body>
</html>
"""

# 1) Insert Voice + QA sections before #shop
voice_section = """
  <section id="voice_content" class="voice_content">
    <div class="inner">
      <picture class="voiceTitle">
        <source srcset="images/voice_content.svg" media="(min-width: 768px)"/>
        <img src="images/voice_content.svg" alt="ãŠå®¢æ§˜ã®å£°">
      </picture>
      <ul>
        <li>
          <img src="images/voice01.svg" class="is-pc" alt="ãŠå®¢æ§˜ã®å£°1">
          <img src="images/voice01_sp.svg" class="is-sp" alt="ãŠå®¢æ§˜ã®å£°1">
        </li>
        <li>
          <img src="images/voice02.svg" class="is-pc" alt="ãŠå®¢æ§˜ã®å£°2">
          <img src="images/voice02_sp.svg" class="is-sp" alt="ãŠå®¢æ§˜ã®å£°2">
        </li>
        <li>
          <img src="images/voice03.svg" class="is-pc" alt="ãŠå®¢æ§˜ã®å£°3">
          <img src="images/voice03_sp.svg" class="is-sp" alt="ãŠå®¢æ§˜ã®å£°3">
        </li>
        <li>
          <img src="images/voice04.svg" class="is-pc" alt="ãŠå®¢æ§˜ã®å£°4">
          <img src="images/voice04_sp.svg" class="is-sp" alt="ãŠå®¢æ§˜ã®å£°4">
        </li>
      </ul>
    </div>
  </section>
"""

qa_section = """
  <section id="qa_content" class="qa_content">
    <div class="inner">
      <picture class="qa-img">
        <source srcset="images/qa_content.svg" media="(min-width: 768px)"/>
        <img src="images/qa_content.svg" alt="ã‚ˆãã‚ã‚‹è³ªå•">
      </picture>
      <h2 class="qaTitle">çš†æ§˜ã‹ã‚‰é ‚ãã‚ˆãã‚ã‚‹ã”è³ªå•ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚<br>ãã®ä»–ã”è³ªå•ã‚„ã”ä¸æ˜ç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰<br class="is-sp">ä½•ãªã‚Šã¨ãŠç”³ã—ä»˜ã‘ãã ã•ã„ã€‚</h2>
      <div class="qa-content">
        <ul>
          <li>
            <div class="qa__item-question">
              <div class="qa__item-question-p"><img src="images/q.svg" alt="Q"> ãªãœã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«ã¯å¿…è¦ãªã®ï¼Ÿ</div>
              <div class="qa__item--open"></div>
            </div>
            <div class="qa__item-answer">
              <p>é‡‘å±è¡¨é¢ã®ä¿è­·ã€é‡‘å±åŒå£«ã®æ‘©æ“¦ã‚’è»½æ¸›ã™ã‚‹ãŸã‚ã§ã™ã€‚</p>
            </div>
          </li>
          <li>
            <div class="qa__item-question">
              <div class="qa__item-question-p"><img src="images/q.svg" alt="Q"> ã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«ã«ã¯ã©ã®ã‚ˆã†ãªåƒããŒã‚ã‚‹ã®ï¼Ÿ</div>
              <div class="qa__item--open"></div>
            </div>
            <div class="qa__item-answer">
              <p>æ½¤æ»‘ä½œç”¨ãƒ»å†·å´ä½œç”¨ãƒ»å¯†å°ä½œç”¨ãƒ»é˜²éŒ†ä½œç”¨ãƒ»æ¸…æµ„ä½œç”¨ãŒã‚ã‚Šã¾ã™ã€‚</p>
            </div>
          </li>
          <li>
            <div class="qa__item-question">
              <div class="qa__item-question-p"><img src="images/q.svg" alt="Q"> ã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«ã¯ã„ã¤äº¤æ›ã—ãŸã‚‰è‰¯ã„ã®ï¼Ÿ</div>
              <div class="qa__item--open"></div>
            </div>
            <div class="qa__item-answer">
              <p>ä¸€èˆ¬çš„ã«ã¯6ãƒ¶æœˆã¾ãŸã¯5,000kmæ¯ãŒæœ›ã¾ã—ã„ã§ã™ã€‚ã‚·ãƒ“ã‚¢ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã§ã¯ã‚ˆã‚ŠçŸ­ã„ã‚µã‚¤ã‚¯ãƒ«ã‚’æ¨å¥¨ã—ã¾ã™ã€‚</p>
            </div>
          </li>
          <li>
            <div class="qa__item-question">
              <div class="qa__item-question-p"><img src="images/q.svg" alt="Q"> ã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«ã£ã¦æ¸›ã‚‹ã®ï¼Ÿ</div>
              <div class="qa__item--open"></div>
            </div>
            <div class="qa__item-answer">
              <p>èµ°è¡ŒçŠ¶æ³ç­‰ã«ã‚ˆã‚Šå¾ã€…ã«æ¸›å°‘ã—ã¾ã™ã€‚é‡ãŒæ¸›ã‚Šã™ãã‚‹ã¨ãƒˆãƒ©ãƒ–ãƒ«ã®åŸå› ã«ãªã‚‹ãŸã‚å®šæœŸçš„ãªç‚¹æ¤œãŒå¿…è¦ã§ã™ã€‚</p>
            </div>
          </li>
          <li>
            <div class="qa__item-question">
              <div class="qa__item-question-p"><img src="images/q.svg" alt="Q"> ç²˜åº¦ã‚°ãƒ¬ãƒ¼ãƒ‰ã£ã¦ãªã«ï¼Ÿ</div>
              <div class="qa__item--open"></div>
            </div>
            <div class="qa__item-answer">
              <p>ã‚ªã‚¤ãƒ«ã®ç¡¬ã•ã‚’SAEç²˜åº¦åˆ†é¡ã§è¡¨ã—ã¾ã™ã€‚ä½æ¸©å´ã«ã€ŒWã€ã‚’ä»˜ã‘ã¦åŒºåˆ¥ã—ã¾ã™ã€‚</p>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </section>
"""

updated_html = current_html.replace(
    '<section id="shop" class="shop">',
    voice_section + "\n" + qa_section + '\n<section id="shop" class="shop">'
)

# 2) Replace map button with embedded Google Map for the store address
address = "å²©æ‰‹çœŒå¤§èˆ¹æ¸¡å¸‚çŒªå·ç”ºä¹…åç•‘4-30"
embed_src = f"https://www.google.com/maps?q={quote(address)}&output=embed"
updated_html = re.sub(
    r'<div class="map"[^>]*>.*?</div>',
    f'''<div class="map"><iframe src="{embed_src}" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe></div>''',
    updated_html,
    flags=re.DOTALL
)

# Write file & zip
index_path.write_text(updated_html, encoding="utf-8")

zip_path = Path("/mnt/data/kobac-oofunato-final.zip")
with ZipFile(zip_path, "w") as z:
    z.write(index_path, arcname="index.html")

{"file": str(index_path), "zip": str(zip_path)}

